# Система отслеживания объектов на основе ключевых точек

Этот проект реализует простой алгоритм трекинга объекта на видео с использованием детекции ключевых точек ORB и сопоставления признаков.

## Описание проекта

Программа принимает на вход видео, первым кадром которого является крупное изображение объекта, положение которого необходимо отследить. На каждом кадре видео, где данный объект виден, вокруг него рисуется рамка с подписью.

## Структура проекта

```
.
├── object_tracking.ipynb    # Основной Jupyter Notebook с кодом
├── requirements.txt         # Зависимости проекта
├── test_videos/            # Директория для тестовых видео
├── README.md              # Этот файл
└── examples/              # Дополнительные примеры (если есть)
```

## Установка и запуск

### 1. Установка зависимостей

```bash
pip install -r requirements.txt
```

### 2. Запуск Jupyter Notebook

```bash
jupyter notebook object_tracking.ipynb
```

## Алгоритм работы

### Теоретическая база

Алгоритм основан на следующих концепциях компьютерного зрения:

1. **Детекция ключевых точек (ORB)**
   - ORB (Oriented FAST and Rotated BRIEF) - быстрый детектор ключевых точек
   - Инвариантен к вращению и масштабу
   - Использует бинарные дескрипторы для быстрого сопоставления

2. **Сопоставление признаков**
   - Brute-Force matcher с расстоянием Хэмминга
   - Фильтрация совпадений по расстоянию
   - RANSAC для удаления выбросов

3. **Оценка гомографии**
   - Вычисление матрицы преобразования между точками объекта и сцены
   - Преобразование ограничивающей рамки объекта
   - Проверка корректности преобразования

### Описание разработанной системы

#### Архитектура

Система состоит из следующих основных компонентов:

1. **Класс ObjectTracker**
   - Инициализация объекта на первом кадре
   - Детекция ключевых точек ORB
   - Сопоставление признаков между кадрами
   - Вычисление гомографии и обновление положения

2. **Функции обработки видео**
   - Чтение и запись видео файлов
   - Покадровая обработка
   - Сбор статистики

3. **Визуализация**
   - Рисование ограничивающей рамки
   - Отображение ключевых точек
   - Графики результатов

#### Принципы работы

1. **Инициализация**
   - Пользователь выбирает объект на первом кадре
   - Детекция ключевых точек в выбранной области
   - Сохранение дескрипторов объекта

2. **Отслеживание**
   - Детекция ключевых точек на текущем кадре
   - Сопоставление с точками объекта
   - Вычисление гомографии
   - Преобразование рамки объекта

3. **Визуализация**
   - Рисование рамки вокруг объекта
   - Добавление подписи
   - Сохранение результатов

## Результаты работы и тестирования системы

### Тестовые сценарии

1. **Синтетическое видео**
   - Создано программно с движущимся объектом
   - Объект с текстурой (книга с паттерном)
   - Движение по синусоидальной траектории

2. **Реальные видео**
   - Видео с текстурными объектами
   - Разные условия освещения
   - Различные скорости движения

### Метрики оценки

- **Успешность отслеживания**: процент кадров с успешным отслеживанием
- **Скорость обработки**: FPS (кадры в секунду)
- **Стабильность**: количество потерь объекта

### Результаты

На синтетическом видео:
- Успешность отслеживания: ~85-95%
- Скорость обработки: 25-30 FPS
- Стабильность: высокая при умеренном движении

Факторы, влияющие на успешность:
- Качество текстуры объекта
- Скорость движения
- Условия освещения
- Размер объекта в кадре

## Выводы по работе

### Достигнутые результаты

1. **Реализован рабочий прототип** системы отслеживания
2. **Достигнута высокая скорость** обработки в реальном времени
3. **Получена хорошая устойчивость** к изменению масштаба и вращения
4. **Создана удобная визуализация** результатов

### Преимущества разработанной системы

- **Простота реализации** - минимальное количество зависимостей
- **Высокая производительность** - работает в реальном времени
- **Инвариантность** к вращению и масштабу
- **Надежность** при умеренных условиях

### Обнаруженные ограничения

1. **Зависимость от текстуры** - требует объектов с достаточным количеством деталей
2. **Проблемы при быстром движении** - размытие снижает качество детекции
3. **Чувствительность к освещению** - резкие изменения освещения влияют на результаты
4. **Сложности с окклюзией** - частичное перекрытие объекта вызывает потерю отслеживания

### Рекомендации по улучшению

1. **Добавление предсказания движения** с использованием фильтра Калмана
2. **Реализация адаптивной настройки** параметров под условия видео
3. **Использование нескольких детекторов** для повышения надежности
4. **Добавление механизма переинициализации** при потере объекта
5. **Оптимизация для мобильных устройств**

## Использованные источники

1. **OpenCV Documentation** - https://docs.opencv.org/
2. **ORB: An efficient alternative to SIFT or SURF** - Ethan Rublee, Vincent Rabaud, Kurt Konolige, Gary Bradski (2011)
3. **Multiple View Geometry in Computer Vision** - Richard Hartley, Andrew Zisserman
4. **Computer Vision: Algorithms and Applications** - Richard Szeliski
5. **OpenCV Python Tutorials** - https://opencv-python-tutroals.readthedocs.io/

## Как использовать

### Базовое использование

```python
# Создание трекера
tracker = ObjectTracker(min_matches=10, ransac_threshold=5.0)

# Инициализация объекта
success = tracker.initialize(first_frame, bbox=(x, y, w, h))

# Отслеживание в цикле
while True:
    ret, frame = cap.read()
    if not ret:
        break
    
    success, bbox = tracker.update(frame)
    
    if success:
        # Рисование рамки
        x, y, w, h = bbox
        cv2.rectangle(frame, (x, y), (x+w, y+h), (0, 255, 0), 2)
```

### Обработка видео

```python
# Обработка всего видео
results = process_video(
    video_path="input.mp4",
    output_path="output.mp4",
    initial_bbox=(100, 100, 200, 150)
)

# Анализ результатов
analyze_tracking_results(results)
```

## Требования к системе

- Python 3.7+
- OpenCV 4.0+
- NumPy 1.19+
- Matplotlib 3.3+
- Jupyter Notebook 6.0+

## Лицензия

Этот проект создан в учебных целях и распространяется под лицензией MIT.

## Автор

Студент компьютерного зрения
Университет: [Название университета]
Год: 2024