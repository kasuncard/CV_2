# Инструкция по тестированию системы отслеживания объектов

Этот документ описывает процесс тестирования системы на различных типах видео.

## Подготовка к тестированию

### 1. Установка зависимостей

```bash
pip install -r requirements.txt
```

### 2. Запуск Jupyter Notebook

```bash
jupyter notebook object_tracking.ipynb
```

## Тестирование на синтетическом видео

### Шаг 1: Создание тестового видео

В Jupyter Notebook выполните ячейку "Создание тестового видео":

```python
test_video_path = "test_videos/sample_video.mp4"
create_sample_video(test_video_path, duration=10, fps=30)
```

### Шаг 2: Запуск отслеживания

Выполните ячейку "Тестирование отслеживания":

```python
initial_bbox = (260, 200, 120, 80)  # (x, y, width, height)
results = process_video(
    video_path=test_video_path,
    output_path="test_videos/tracked_output.mp4",
    initial_bbox=initial_bbox
)
```

### Шаг 3: Анализ результатов

Выполните ячейку анализа:

```python
analyze_tracking_results(results)
```

## Тестирование на реальных видео

### Вариант 1: Видео с книгой

1. **Подготовка видео**:
   - Запишите видео с книгой на столе
   - Первый кадр должен содержать крупное изображение книги
   - Длительность: 10-15 секунд
   - Разрешение: минимум 640x480

2. **Запуск теста**:
```python
# Замените на путь к вашему видео
video_path = "path/to/your/book_video.mp4"
initial_bbox = (100, 100, 200, 150)  # Настройте под ваше видео

results = test_custom_video(video_path, initial_bbox)
```

### Вариант 2: Видео с коробкой

1. **Подготовка видео**:
   - Используйте коробку с текстурой (например, картонная коробка с рисунком)
   - Двигайте камеру вокруг коробки
   - Изменяйте расстояние до объекта

2. **Запуск теста**:
```python
video_path = "path/to/your/box_video.mp4"
initial_bbox = (150, 120, 180, 120)

results = test_custom_video(video_path, initial_bbox)
```

### Вариант 3: Видео с плакатом

1. **Подготовка видео**:
   - Используйте плакат или картину с текстурой
   - Двигайте камеру с разной скоростью
   - Изменяйте угол обзора

2. **Запуск теста**:
```python
video_path = "path/to/your/poster_video.mp4"
initial_bbox = (200, 150, 240, 180)

results = test_custom_video(video_path, initial_bbox)
```

## Использование демо-скрипта

### Создание и тестирование демо-видео

```bash
python demo.py --create-demo
```

### Тестирование существующего видео

```bash
python demo.py --input your_video.mp4
```

### Тестирование с заданной рамкой

```bash
python demo.py --input your_video.mp4 --bbox 100 100 200 150
```

### Сохранение результата

```bash
python demo.py --input your_video.mp4 --output result.mp4
```

## Оценка результатов

### Критерии успешности

1. **Высокая успешность (>80%)**:
   - Объект отслеживается на большинстве кадров
   - Рамка точно следует за объектом
   - Минимальные потери отслеживания

2. **Средняя успешность (60-80%)**:
   - Периодические потери отслеживания
   - Некоторые неточности в позиционировании рамки
   - Восстановление отслеживания после потерь

3. **Низкая успешность (<60%)**:
   - Частые потери отслеживания
   - Неправильное позиционирование рамки
   - Трудности с восстановлением

### Факторы, влияющие на успешность

1. **Качество текстуры объекта**:
   - Хорошо: книги, журналы, коробки с рисунками
   - Плохо: однотонные поверхности, гладкие объекты

2. **Условия освещения**:
   - Хорошо: стабильное освещение, резкие тени
   - Плохо: резкие изменения освещения, блики

3. **Скорость движения**:
   - Хорошо: умеренное движение
   - Плохо: очень быстрое движение, размытие

4. **Размер объекта**:
   - Хорошо: объект занимает 10-50% кадра
   - Плохо: очень маленький или очень большой объект

## Сравнение параметров

### Тестирование разных параметров

В Jupyter Notebook выполните:

```python
comparison_results = compare_parameters(test_video_path, initial_bbox)
```

### Анализ влияния параметров

1. **min_matches**:
   - Маленькие значения (5-8): выше чувствительность, больше ложных срабатываний
   - Большие значения (15-20): выше надежность, меньше ложных срабатываний

2. **ransac_threshold**:
   - Маленькие значения (2-3): точнее, но чувствительнее к шуму
   - Большие значения (8-10): устойчивее к шуму, но менее точны

## Создание собственного видео

### Рекомендации по записи

1. **Выбор объекта**:
   - Используйте объекты с богатой текстурой
   - Избегайте однотонных поверхностей
   - Предпочтительны плоские объекты с четкими границами

2. **Условия съемки**:
   - Стабильное освещение
   - Минимум бликов и отражений
   - Контраст между объектом и фоном

3. **Движение**:
   - Начните с крупного плана объекта
   - Двигайте камеру плавно
   - Изменяйте расстояние и угол постепенно

### Примеры хороших объектов

- Книги с обложками
- Журналы
- Коробки с рисунками
- Плакаты
- Этикетки на продуктах
- Текстильные узоры

## Устранение常见 проблем

### Проблема: Низкая успешность отслеживания

**Решения**:
1. Увеличьте `min_matches` до 15-20
2. Уменьшите `ransac_threshold` до 3.0
3. Используйте объект с лучшей текстурой
4. Улучшите условия освещения

### Проблема: Потеря отслеживания при движении

**Решения**:
1. Уменьшите скорость движения камеры
2. Увеличьте частоту кадров видео
3. Используйте более стабильное освещение

### Проблема: Неправильная рамка

**Решения**:
1. Точнее выберите начальную рамку
2. Увеличьте `ransac_threshold`
3. Проверьте качество первого кадра

## Документирование результатов

Для каждого теста записывайте:

1. **Информация о видео**:
   - Тип объекта
   - Разрешение и длительность
   - Условия освещения

2. **Параметры трекера**:
   - `min_matches`
   - `ransac_threshold`

3. **Результаты**:
   - Успешность отслеживания (%)
   - Среднее время обработки кадра
   - Количество потерь отслеживания

4. **Наблюдения**:
   - Особенности поведения трекера
   - Проблемные моменты
   - Рекомендации по улучшению

Это поможет систематизировать результаты и сделать выводы о работе системы.